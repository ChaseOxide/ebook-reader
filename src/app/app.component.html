<router-outlet></router-outlet>

<ng-container *ngIf="visible$ | async">
  <div *ngIf="autoScrollerService.activated" class="top-overlay auto-mode-container">
    <span class="uppercase">Auto</span> ({{ autoScrollerService.multiplier }}x)
  </div>

  <div class="top-overlay action-icon-container">
    <label class="no-margin">
      <fa-icon class="action-icon" [icon]="faFileMedical"></fa-icon>
      <input type="file" accept=".htmlz,.epub" multiple (change)="onInputChange(inputRef)" hidden #inputRef>
    </label>
    <label class="no-margin" *ngIf="!isMobileDevice">
      <fa-icon class="action-icon margin-icon" [icon]="faFolderPlus"></fa-icon>
      <input type="file" webkitdirectory directory multiple (change)="onInputChange(inputDirRef)" hidden #inputDirRef>
    </label>
    <div class="action-icon margin-icon custom-svg-icon" (click)="openBookManager()">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 47 41.5">
        <g fill="none" stroke="currentColor">
          <rect x="2.0574" y="2.0847" width="21.995" height="37.363" rx="1.5" ry="1.5" stroke-width="4"/>
          <rect transform="rotate(-10.818 36.05 21.207)" x="30.414" y="3.7891" width="11.272" height="34.836" rx="1.5" ry="1.5" stroke-width="4.5"/>
          <line x1="2.6831" x2="24.065" y1="11.579" y2="11.579" stroke-width="3.5"/>
          <line x1="2.3748" x2="23.756" y1="30.568" y2="30.568" stroke-width="3.5"/>
          <line x1="13.339" x2="13.339" y1="2.2896" y2="38.56" stroke-width="3.5"/>
        </g>
      </svg>
    </div>
    <fa-icon class="action-icon margin-icon" [icon]="faBookmark" (click)="bookmarManagerService.saveScrollPosition()">
    </fa-icon>
    <fa-icon class="action-icon margin-icon" [icon]="faCog" (click)="setShowSettingsDialog(true)"></fa-icon>
  </div>
  <div class="top-overlay action-icon-container--left">
    <fa-icon class="action-icon margin-icon"
      *ngIf="!(minimalUi$ | async) && supportsFullscreen && !autoScrollerService.activated" [icon]="faExpand"
      (click)="toggleFullscreen()"></fa-icon>
  </div>
</ng-container>

<div class="overlay-container loading-container"
  *ngIf="loadingDb || (ebookDisplayManagerService.loadingFile$ | async); else notLoadingRef">
  Loading...
</div>

<div class="overlay-container loading-container drop-zone-container darker"
  *ngIf="(ebookDisplayManagerService.loadingFiles$ | async)">
  <div class="progress-container">
    <div class="truncate">{{ebookDisplayManagerService.loadingFiles$.value?.title}}</div>
    <div class="progress">
      <span [style.width]="ebookDisplayManagerService.loadingFiles$.value?.progress"></span>
    </div>
  </div>
</div>

<ng-template #notLoadingRef>
  <label class="overlay-container drop-zone-container label-button"
    *ngIf="!(visible$ | async) && !(bookManagerService.managerIsOpen$ | async)" (click)="zoneInputRef.click();"
    (contextmenu)="$event.preventDefault();zoneInputDirRef.click();">
    {{dropZoneLabel}}
  </label>
  <input type="file" accept=".htmlz,.epub" multiple hidden #zoneInputRef (change)="onInputChange(zoneInputRef)">
  <input type="file" webkitdirectory directory multiple hidden #zoneInputDirRef
    (change)="onInputChange(zoneInputDirRef)">
</ng-template>

<div class="dialog-overlay" *ngIf="showSettingsDialog" (click)="setShowSettingsDialog(false)">
  <app-settings-dialog class="settings-dialog" (closeClick)="setShowSettingsDialog(false)"
    (click)="$event.stopPropagation()"></app-settings-dialog>
</div>

<fa-icon *ngIf="isUpdateAvailable" [icon]="faSyncAlt" class="information-overlay bottom-overlay update-ready-icon">
</fa-icon>
