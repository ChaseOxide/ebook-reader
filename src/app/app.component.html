<router-outlet></router-outlet>

<ng-container *ngIf="visible$ | async">
  <div *ngIf="autoScrollerService.activated" class="top-overlay auto-mode-container">
    <span class="uppercase">Auto</span> ({{ autoScrollerService.multiplier }}x)
  </div>

  <div class="top-overlay action-icon-container">
    <label class="no-margin">
      <fa-icon class="action-icon" [icon]="faFileMedical"></fa-icon>
      <input type="file" accept=".htmlz,.epub" multiple (change)="onInputChange(inputRef)" hidden #inputRef>
    </label>
    <label class="no-margin" *ngIf="!isMobileDevice">
      <fa-icon class="action-icon margin-icon" [icon]="faFolderPlus"></fa-icon>
      <input type="file" webkitdirectory directory multiple (change)="onInputChange(inputDirRef)" hidden #inputDirRef>
    </label>
    <div class="action-icon margin-icon custom-svg-icon" (click)="openBookManager()">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 643.37 560">
        <path fill="currentColor" d="m336 0H48C21.49 0 0 21.49 0 48v464c0 26.51 21.49 48 48 48h288c26.51 0 48-21.49 48-48V48c0-26.51-21.49-48-48-48zm0 166H209V48h121c3.314 0 6 2.683 6 5.996zm-161 0H48V54a6 6 0 016-6h121zm0 33v160H48V199zm34 0h127v160H209zm0 194h127v113c0 3.314-2.683 6-6 6H209zm-34 0v119H54c-3 0-6-2.683-6-6V393zM518.154 86.973l-110.998 21.174c-26.041 4.968-43.123 30.104-38.156 56.145l68.207 357.552c4.968 26.041 30.104 43.123 56.144 38.156l110.999-21.175c26.04-4.967 43.123-30.103 38.155-56.144l-68.207-357.552c-4.967-26.041-30.103-43.123-56.144-38.156zm76.077 398.809c.621 3.255-1.511 6.396-4.769 7.018l-99.211 18.925c-3.256.621-6.397-1.511-7.018-4.769l-65.958-345.765a6 6 0 014.769-7.018l99.211-18.926c3.255-.621 6.396 1.512 7.018 4.77z"/>
      </svg>
    </div>
    <fa-icon class="action-icon margin-icon" [icon]="faBookmark" (click)="bookmarManagerService.saveScrollPosition()">
    </fa-icon>
    <fa-icon class="action-icon margin-icon" [icon]="faCog" (click)="setShowSettingsDialog(true)"></fa-icon>
  </div>
  <div class="top-overlay action-icon-container--left">
    <fa-icon class="action-icon margin-icon"
      *ngIf="!(minimalUi$ | async) && supportsFullscreen && !autoScrollerService.activated" [icon]="faExpand"
      (click)="toggleFullscreen()"></fa-icon>
  </div>
</ng-container>

<div class="overlay-container loading-container"
  *ngIf="loadingDb || (ebookDisplayManagerService.loadingFile$ | async); else notLoadingRef">
  Loading...
</div>

<div class="overlay-container loading-container drop-zone-container darker"
  *ngIf="(ebookDisplayManagerService.loadingFiles$ | async)">
  <div class="progress-container">
    <div class="truncate">{{ebookDisplayManagerService.loadingFiles$.value?.title}}</div>
    <div class="progress">
      <span [style.width]="ebookDisplayManagerService.loadingFiles$.value?.progress"></span>
    </div>
  </div>
</div>

<ng-template #notLoadingRef>
  <label class="overlay-container drop-zone-container label-button"
    *ngIf="!(visible$ | async) && !(bookManagerService.managerIsOpen$ | async)" (click)="zoneInputRef.click();"
    (contextmenu)="$event.preventDefault();zoneInputDirRef.click();">
    {{dropZoneLabel}}
  </label>
  <input type="file" accept=".htmlz,.epub" multiple hidden #zoneInputRef (change)="onInputChange(zoneInputRef)">
  <input type="file" webkitdirectory directory multiple hidden #zoneInputDirRef
    (change)="onInputChange(zoneInputDirRef)">
</ng-template>

<div class="dialog-overlay" *ngIf="showSettingsDialog" (click)="setShowSettingsDialog(false)">
  <app-settings-dialog class="settings-dialog" (closeClick)="setShowSettingsDialog(false)"
    (click)="$event.stopPropagation()"></app-settings-dialog>
</div>

<fa-icon *ngIf="isUpdateAvailable" [icon]="faSyncAlt" class="information-overlay bottom-overlay update-ready-icon">
</fa-icon>
